---
router_id: '100.2.0.1'
interfaces:
  - name: loopback0
    description: 'Routing loopback interface'
    enable: true
    ipv4:
      - address: 100.2.0.1/32
        tag: 100
    ospf:
      - afi: ipv4
        processes:
          - process_id: "{{ global_ospfv2['process_id'] }}"
            area:
              area_id: "{{ global_ospfv2['area_id'] }}"
    pim:
      sparse: true
  - name: loopback2
    description: 'Primary loopback interface for Phantom RP'
    enable: true
    ipv4:
      - address: 100.254.254.1/32
    ospf:
      - afi: ipv4
        network: 'point-to-point'
        processes:
          - process_id: "{{ global_ospfv2['process_id'] }}"
            area:
              area_id: "{{ global_ospfv2['area_id'] }}"
    pim:
      sparse: true
  - name: loopback3
    description: 'Fallback loopback interface for Phantom RP'
    enable: true
    ipv4:
      - address: 100.254.254.3/32
    ospf:
      - afi: ipv4
        network: 'point-to-point'
        processes:
          - process_id: "{{ global_ospfv2['process_id'] }}"
            area:
              area_id: "{{ global_ospfv2['area_id'] }}"
    pim:
      sparse: true
  - name: Ethernet1/1
    description: 'Connected to dc1-leaf1 Ethernet1/1'
    enable: true
    mtu: 9216
    mode: layer3
    ipv4:
      - address: 100.2.8.4/31
        tag: 100
    ospf:
      - afi: ipv4
        network: 'point-to-point'
        processes:
          - process_id: "{{ global_ospfv2['process_id'] }}"
            area:
              area_id: "{{ global_ospfv2['area_id'] }}"
    pim:
      sparse: true
    redirects: false
    ipv6_redirects: false
  - name: Ethernet1/2
    description: 'Connected to dc1-leaf2 Ethernet1/1'
    enable: true
    mtu: 9216
    mode: layer3
    ipv4:
      - address: 100.2.8.6/31
        tag: 100
    ospf:
      - afi: ipv4
        network: 'point-to-point'
        processes:
          - process_id: "{{ global_ospfv2['process_id'] }}"
            area:
              area_id: "{{ global_ospfv2['area_id'] }}"
    pim:
      sparse: true
    redirects: false
    ipv6_redirects: false
  - name: Ethernet1/3
    description: 'Connected to dc1-leaf3 Ethernet1/1'
    enable: true
    mtu: 9216
    mode: layer3
    ipv4:
      - address: 100.2.8.10/31
        tag: 100
    ospf:
      - afi: ipv4
        network: 'point-to-point'
        processes:
          - process_id: "{{ global_ospfv2['process_id'] }}"
            area:
              area_id: "{{ global_ospfv2['area_id'] }}"
    pim:
      sparse: true
    redirects: false
    ipv6_redirects: false
  - name: Ethernet1/5
    description: 'Connected to dc1-bgw1 Ethernet1/1'
    enable: true
    mtu: 9216
    mode: layer3
    ipv4:
      - address: 100.2.8.14/31
        tag: 100
    ospf:
      - afi: ipv4
        network: 'point-to-point'
        processes:
          - process_id: "{{ global_ospfv2['process_id'] }}"
            area:
              area_id: "{{ global_ospfv2['area_id'] }}"
    pim:
      sparse: true
    redirects: false
    ipv6_redirects: false
  - name: Ethernet1/6
    description: 'Connected to dc1-bgw2 Ethernet1/1'
    enable: true
    mtu: 9216
    mode: layer3
    ipv4:
      - address: 100.2.8.18/31
        tag: 100
    ospf:
      - afi: ipv4
        network: 'point-to-point'
        processes:
          - process_id: "{{ global_ospfv2['process_id'] }}"
            area:
              area_id: "{{ global_ospfv2['area_id'] }}"
    pim:
      sparse: true
    redirects: false
ospfv2:
  processes:
    - process_id: "{{ global_ospfv2['process_id'] }}"
      router_id: '{{ router_id }}'
      bfd: true
bgp_neighbors:
  leaf1: '{{ hostvars["dc1-leaf1"]["router_id"] }}'
  leaf2: '{{ hostvars["dc1-leaf2"]["router_id"] }}'
  leaf3: '{{ hostvars["dc1-leaf3"]["router_id"] }}'
  bgw1: '{{ hostvars["dc1-bgw1"]["router_id"] }}'
  bgw2: '{{ hostvars["dc1-bgw2"]["router_id"] }}'
bgp:
  global:
    as_number: '{{ bgp_global["asn"] }}'
    router_id: '{{ router_id }}'
    neighbors:
      - neighbor_address: '{{ bgp_neighbors["leaf1"] }}'
        remote_as: '{{ bgp_global["asn"] }}'
        update_source: loopback0
        bfd:
          set: true
      - neighbor_address: '{{ bgp_neighbors["leaf2"] }}'
        remote_as: '{{ bgp_global["asn"] }}'
        update_source: loopback0
        bfd:
          set: true
      - neighbor_address: '{{ bgp_neighbors["leaf3"] }}'
        remote_as: '{{ bgp_global["asn"] }}'
        update_source: loopback0
        bfd:
          set: true
      - neighbor_address: '{{ bgp_neighbors["bgw1"] }}'
        remote_as: '{{ bgp_global["asn"] }}'
        update_source: loopback0
        bfd:
          set: true
      - neighbor_address: '{{ bgp_neighbors["bgw2"] }}'
        remote_as: '{{ bgp_global["asn"] }}'
        update_source: loopback0
        bfd:
          set: true
  neighbors:
    - neighbor_address: '{{ bgp_neighbors["leaf1"] }}'
      address_family:
        - afi: l2vpn
          safi: evpn
          route_reflector_client: true
          send_community:
            standard: true
            extended: true
    - neighbor_address: '{{ bgp_neighbors["leaf2"] }}'
      address_family:
        - afi: l2vpn
          safi: evpn
          route_reflector_client: true
          send_community:
            standard: true
            extended: true
    - neighbor_address: '{{ bgp_neighbors["leaf3"] }}'
      address_family:
        - afi: l2vpn
          safi: evpn
          route_reflector_client: true
          send_community:
            standard: true
            extended: true
    - neighbor_address: '{{ bgp_neighbors["bgw1"] }}'
      address_family:
        - afi: l2vpn
          safi: evpn
          route_reflector_client: true
          send_community:
            standard: true
            extended: true
    - neighbor_address: '{{ bgp_neighbors["bgw2"] }}'
      address_family:
        - afi: l2vpn
          safi: evpn
          route_reflector_client: true
          send_community:
            standard: true
            extended: true
multicast:
  rp:
    - address: 100.254.254.1
      group_list: 239.1.1.0/26
      bidir: true
    - address: 100.254.254.3
      group_list: 239.1.1.64/26
      bidir: true
